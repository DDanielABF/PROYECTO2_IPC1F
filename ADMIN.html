<!DOCTYPE html>
<html lang="es">

<head>
    <title>admin</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>


<body onload="mostrartablaE(),mostrartabla(),mostrartablaP(),mostrartablaM()" background="admin234.jpg">
    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
        <br />
        <button onclick="regresar()" class="btn btn-primary me-md-2" type="button">cerrar sesion</button>
        <button onclick="test(),pdfEnfermero()" class="btn btn-primary" type="button">generar todos los reportes
            pdf</button>
    </div>
    <div class="container">
        <h1 color="white">BIENVENIDO ABNER</h1>
        <p>informacion de administrador</p>
        <ul class="nav nav-pills" role="tablist">
            <li class="active"><a data-toggle="pill" href="#home">medicos</a></li>
            <li><a data-toggle="pill" href="#menu1">enfermeros</a></li>
            <li><a data-toggle="pill" href="#menu2">pacientes</a></li>
            <li><a data-toggle="pill" href="#menu3">medicamentos</a></li>
        </ul>

        <div class="tab-content">
            <div id="home" class="tab-pane fade in active" role="tabpanel">
                <br>
                <input type="file" class="form-control" id="file"></input>
                <button onclick="CargaMasiva()" type="button" class="btn btn-secondary btn-lg">Cargar Medicos</button>
                <div style="width: 25; float: center;" id="Daniel">
                    <center>
                        <h2>VISUALIZACION DE MEDICOS</h2>
                        <center>
                            <table class="table table-bordered border-primary">
                                <thead class="thead-dark">
                                    <tr class="table-info">
                                        <th> Nombre </th>
                                        <th> Apellido </th>

                                        <th> sexo </th>
                                        <th> usuario </th>

                                        <th> especialidad </th>
                                        <th> telefono </th>
                                        <th>
                                            <center>opciones</center>
                                        </th>
                                    </tr>
                                </thead>
                                <!-- Al igual que los input, a la tabla que queremos agregarle informacion
          Tambien le agregamos un id. -->
                                <tbody id="detalles"></tbody>
                            </table>
                </div>
                <center> <button onclick="test()" class="btn btn-primary" type="button">generar reporte pdf </button>
                </center>
            </div>
            <div id="menu1" class="tab-pane fade">
                <br>
                <input type="file" class="form-control" id="fileE"></input>
                <button onclick="CargaMasivaE()" type="button" class="btn btn-secondary btn-lg">Cargar
                    Enfermeros</button>
                <br>
                <div style="width: 25; float: center;" id="DanielE">
                    <center>
                        <h2>VISUALIZACION DE ENFERMEROS</h2>
                        <center>
                            <table class="table table-bordered border-primary">
                                <thead class="thead-dark">
                                    <tr class="table-info">
                                        <th> Nombre </th>
                                        <th> Apellido </th>

                                        <th> sexo </th>
                                        <th> usuario </th>


                                        <th> telefono </th>
                                        <th>
                                            <center>opciones</center>
                                        </th>
                                    </tr>
                                </thead>
                                <!-- Al igual que los input, a la tabla que queremos agregarle informacion
              Tambien le agregamos un id. -->
                                <tbody id="detallesE"></tbody>
                            </table>
                </div>
                <center> <button onclick="pdfEnfermero()" class="btn btn-primary" type="button">generar reporte pdf
                    </button></center>
            </div>
            <div id="menu2" class="tab-pane fade">
                <br>

                <input type="file" class="form-control" id="fileP"></input>
                <button onclick="CargaMasivaP()" type="button" class="btn btn-secondary btn-lg">Cargar
                    Pacientes</button>

                <br>
                <div style="width: 25; float: center;" id="DanielP">
                    <center>
                        <h2>VISUALIZACION DE PACIENTES</h2>
                        <center>
                            <table class="table table-bordered border-primary">
                                <thead class="thead-dark">
                                    <tr class="table-info">
                                        <th> Nombre </th>
                                        <th> Apellido </th>

                                        <th> sexo </th>
                                        <th> usuario </th>


                                        <th> telefono </th>
                                        <th>
                                            <center>opciones</center>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="detallesP"></tbody>
                            </table>
                </div>
                <center> <button onclick="pdfPaciente()" class="btn btn-primary" type="button">generar reporte pdf
            </div>

            <div id="menu3" class="tab-pane fade">
                <br>
                <input type="file" class="form-control" id="fileM"></input>
                <button onclick="CargaMasivaM()" type="button" class="btn btn-secondary btn-lg">Cargar
                    Medicamentos</button>
                <br>
                <div style="width: 25; float: center;" id="DanielM">
                    <center>
                        <h2>VISUALIZACION MEDICAMENTOS</h2>
                        <center>
                            <table class="table table-bordered border-primary">
                                <thead class="thead-dark">
                                    <tr class="table-info">

                                        <th> ID </th>
                                        <th> Nombre </th>
                                        <th> Precio </th>

                                        <th> Descripcion </th>
                                        <th> Cantidad </th>


                                        <th>
                                            <center>opciones</center>
                                        </th>
                                    </tr>
                                </thead>
                                <!-- Al igual que los input, a la tabla que queremos agregarle informacion
              Tambien le agregamos un id. -->
                                <tbody id="detallesM"></tbody>
                            </table>
                </div>
                <center> <button onclick="pdfMedicamento()" class="btn btn-primary" type="button">generar reporte pdf</button>></center>>
            </div>
 
        </div>
        <!-- Optional JavaScript; choose one of the two! -->

        <!-- Option 1: Bootstrap Bundle with Popper -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/2.3.2/jspdf.plugin.autotable.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
            crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.4.1/jspdf.min.js"></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/2.3.5/jspdf.plugin.autotable.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script src="papaparse.min.js"></script>
        <script src="html2pdf.bundle.js"></script>
        <script>


            function CargaInfo() {
                console.log("usarlo para mandar a tabla")



            }
            function CargaMasiva() {

                $('#file').parse({
                    config: {
                        delimiter: ",",
                        complete: GuardarUsuarios,
                    },
                    before: function (file, inputElem) {
                        console.log("parsing.file...", file);
                    },
                    error: function (err, file) {
                        console.log("ERROR", err, file)
                    },
                    complete: function () {
                        console.log("done with all files")
                        // CargarInfo()
                    }


                });

                function GuardarUsuarios(resultados) {
                    console.log(resultados.data)
                    var data = resultados.data
                    data.shift();
                    data.forEach(element => {
                        console.log("esto es element")
                        console.log(element)
                        console.log("element en x posicion")
                        console.log(element[6])
                        var objDoctor = {
                            'nombre': element[0],
                            'apellido': element[1],
                            'nacimiento': element[2],
                            'sexo': element[3],
                            'usuario': element[4],
                            'contra': element[5],
                            'especialidad': element[6],
                            'telefono': element[7]


                        }
                        console.log("imprimiendo el objeto ya guardado")
                        console.log(objDoctor)
                        if (objDoctor.nombre != null) {
                            fetch('http://localhost:3000/mostrarDoctores', {
                                method: 'POST',
                                body: JSON.stringify(objDoctor),
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Access-Control-Allow-Origin': '*',
                                }
                            })

                                /* SIMULANDO UN TRY - CATCH
                                    El metodo fetch trabaja como una Promesa en JavaScript, representa el estado final del metodo
                                    como si de un return se tratase.
                                    .then: Para indicar que es lo que hara la respuesta del metodo, el primer then sirve para transformar la respuesta 
                                    a un JSON entendible para JavaScript.
                                    .catch: Para indicar que es lo que se hara si se obtuvo un fracaso.
                                */
                                .then(res => res.json())

                                .catch(err => {
                                    console.error('Error:', err)
                                    alert("Ocurrio un error, ver la consola")
                                })
                                /* ULTIMA TRANSFORMACION
                                    Si el metodo funciono correctamente y se logro transformar la respuesta en un JSON, hara lo que este dentro de las llaves.
                                */
                                .then(response => {
                                    // En este apargado, se haran las acciones si la respuesta fue correcta.
                                    console.log(response);
                                    // Usamos un alert, para desplegar un mensaje en pantalla de parte del navegador
                                    // Esto se puede reemplazar con mas librerias.
                                    //alert(response.Mensaje)


                                    //  llamar un metodo definido
                                    //ObtenerDatos()
                                })//fetch
                        }


                    });


                }



            }

            function mostrartabla() {
                var tabla = document.querySelector('#detalles')

                // Esta cadena nos servira para escribir los datos en la tabla.
                var cadena = ''

                fetch('http://localhost:3000/doctores', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Access-Control-Allow-Origin': '*',
                    }
                })
                    .then(res => res.json())
                    .catch(err => {
                        console.error('Error:', err)
                        alert("Ocurrio un error, ver la consola")
                    })
                    .then(response => {
                        console.log(response);
                        // Usamos un foreach para darle el valor a un objeto dentro de un arreglo.

                        // arreglo.forEach(variable => {que se hara dentro del for})
                        response.forEach(element => {
                            // En este caso, element es el objeto que esta recorriendo el for, entonces por cada iteracion manipulamos a element
                            console.log(element)
                            // Agregamos a la cadena los datos de la respuesta del JSON para agregarlo a un table.
                            cadena += `<tr bgcolor="#85C1E9 " onmouseover="a(this,'#FDFEFE ')" onmouseout="b(this,'#85C1E9 ')">
                        <td> ${element.Nombre} </td>
                        <td> ${element.Apellido} </td>
                        <td> ${element.Sexo} </td>
                        <td> ${element.Usuario} </td>
                        <td> ${element.especialidad} </td>
                        <td> ${element.telefono} </td>
                        <td> <button value=${element.Usuario} onclick="verPerfil(this)" type="button" class="btn btn-outline-dark">Ver Perfil</button> 
                         <button value=${element.Usuario} onclick="verPerfil(this)" type="button" class="btn btn-outline-dark">Actualizar</button> 
                      <button value=${element.Usuario} onclick="Eliminar(this)" type="button" class="btn btn-outline-dark">Eliminar</button></td>
                      
                      </tr>`
                            // Cabe destacar que tambien se pueden agregar otras etiquetas, en si se trabaja como texto.
                            // NOTA: Recuerden no user '' si no que `` para que los deje usar el ${} y agregar variables al texto.
                        });

                        // POR ULTIMO: Usamos innerHTML para agregar el HTML a la etiqueta que indicamos anteriormente.
                        tabla.innerHTML = cadena
                    })
            }

            function login() { }

            // METODO MODIFICAR

            // METODOS DOCTORES
            function Eliminar(button) {
                console.log(button)
                var nombre = button.value

                fetch(`http://localhost:3000/doctores/${nombre}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                        'Access-Control-Allow-Origin': '*',
                    }
                })
                    .then(res => res.json())
                    .catch(err => {
                        console.error('Error:', err)
                        alert("Ocurrio un error, ver la consola")
                    })
                    .then(response => {
                        console.log(response);
                        alert(response.Mensaje)
                        Actualizar()
                    })





            }
            function Actualizar() {


                window.location.href = 'ADMIN.html'


            }


            function pdfDoctores() {


            }
            function verPerfil(boton) {
                console.log(boton)
                // En mi caso, yo use el value, lo asignamos a una variable.
                var usuario = boton.value

                /* sessionStorage, javascript cuenta con un almacenamiento para la pagina, este almacenamiento
                    estara vigente hasta que se cierre la pagina, es ideal para almacenar datos entre paginas.
                    Usamos el storage.setItem("llave", valor) donde llave es el atributo donde se guardara el valor del sessionStorage
                */
                sessionStorage.setItem("buscar", usuario)

                // CAMBIAR DE PAGINA, SIN USAR OTRA PAGINA
                // Usamos el location.href = "Pagina.html" para cambiar la pagina actual.
                location.href = "Perfil.html"
            }
            function test() {
                // Get the element.
                var element = document.getElementById('Daniel');

                // Generate the PDF.
                html2pdf().from(element).set({
                    margin: 0.5,
                    filename: 'doctores.pdf',
                    html2canvas: { scale: 10 },
                    jsPDF: { orientation: 'landscape', unit: 'in', format: 'letter', compressPDF: true }
                }).save();
            }
            function regresar() {

                location.href = "Index.html"
            }

            function a(objeto, color) {
                if (!objeto.contains(event.fromElement)) {
                    objeto.bgColor = color;
                }
            }
            function b(objeto, color) {
                if (!objeto.contains(event.toElement)) {
                    objeto.bgColor = color;
                }
            }


            //METODOS PARA ENFERMERAS

            function mostrartablaE() {
                var tabla = document.querySelector('#detallesE')

                // Esta cadena nos servira para escribir los datos en la tabla.
                var cadena = ''

                fetch('http://localhost:3000/enfermeras', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Access-Control-Allow-Origin': '*',
                    }
                })
                    .then(res => res.json())
                    .catch(err => {
                        console.error('Error:', err)
                        alert("Ocurrio un error, ver la consola")
                    })
                    .then(response => {
                        console.log(response);
                        // Usamos un foreach para darle el valor a un objeto dentro de un arreglo.

                        // arreglo.forEach(variable => {que se hara dentro del for})
                        response.forEach(element => {
                            // En este caso, element es el objeto que esta recorriendo el for, entonces por cada iteracion manipulamos a element
                            console.log(element)
                            // Agregamos a la cadena los datos de la respuesta del JSON para agregarlo a un table.
                            cadena += `<tr bgcolor="#85C1E9 " onmouseover="a(this,'#FDFEFE ')" onmouseout="b(this,'#85C1E9 ')">
                        <td> ${element.Nombre} </td>
                        <td> ${element.Apellido} </td>
                        <td> ${element.Sexo} </td>
                        <td> ${element.Usuario} </td>
                        <td> ${element.telefono} </td>
                        <td> <button value=${element.Usuario} onclick="verPerfilE(this)" type="button" class="btn btn-outline-dark">Ver Perfil</button> 
                         <button value=${element.Usuario} onclick="verPerfilE(this)" type="button" class="btn btn-outline-dark">Actualizar</button> 
                      <button value=${element.Usuario} onclick="EliminarE(this)" type="button" class="btn btn-outline-dark">Eliminar</button></td>
                      
                      </tr>`
                            // Cabe destacar que tambien se pueden agregar otras etiquetas, en si se trabaja como texto.
                            // NOTA: Recuerden no user '' si no que `` para que los deje usar el ${} y agregar variables al texto.
                        });

                        // POR ULTIMO: Usamos innerHTML para agregar el HTML a la etiqueta que indicamos anteriormente.
                        tabla.innerHTML = cadena
                    })
            }
            function CargaMasivaE() {

                $('#fileE').parse({
                    config: {
                        delimiter: ",",
                        complete: GuardarUsuariosE,
                    },
                    before: function (file, inputElem) {
                        console.log("parsing.file...", file);
                    },
                    error: function (err, file) {
                        console.log("ERROR", err, file)
                    },
                    complete: function () {
                        console.log("done with all files")
                        // CargarInfo()
                    }


                });

                function GuardarUsuariosE(resultados) {
                    console.log(resultados.data)
                    var data = resultados.data
                    data.shift();
                    data.forEach(element => {
                        console.log("esto es element")
                        console.log(element)
                        console.log("element en x posicion")
                        console.log(element[6])
                        var objEnfermero = {
                            'nombre': element[0],
                            'apellido': element[1],
                            'nacimiento': element[2],
                            'sexo': element[3],
                            'usuario': element[4],
                            'contra': element[5],
                            'telefono': element[6]


                        }
                        console.log("imprimiendo el objeto ya guardado")
                        console.log(objEnfermero)
                        if (objEnfermero.nombre != null) {
                            fetch('http://localhost:3000/mostrarEnfermeras', {
                                method: 'POST',
                                body: JSON.stringify(objEnfermero),
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Access-Control-Allow-Origin': '*',
                                }
                            })

                                /* SIMULANDO UN TRY - CATCH
                                    El metodo fetch trabaja como una Promesa en JavaScript, representa el estado final del metodo
                                    como si de un return se tratase.
                                    .then: Para indicar que es lo que hara la respuesta del metodo, el primer then sirve para transformar la respuesta 
                                    a un JSON entendible para JavaScript.
                                    .catch: Para indicar que es lo que se hara si se obtuvo un fracaso.
                                */
                                .then(res => res.json())

                                .catch(err => {
                                    console.error('Error:', err)
                                    alert("Ocurrio un error, ver la consola")
                                })
                                /* ULTIMA TRANSFORMACION
                                    Si el metodo funciono correctamente y se logro transformar la respuesta en un JSON, hara lo que este dentro de las llaves.
                                */
                                .then(response => {
                                    // En este apargado, se haran las acciones si la respuesta fue correcta.
                                    console.log(response);
                                    // Usamos un alert, para desplegar un mensaje en pantalla de parte del navegador
                                    // Esto se puede reemplazar con mas librerias.
                                    //alert(response.Mensaje)


                                    //  llamar un metodo definido
                                    //ObtenerDatos()
                                })//fetch
                        }


                    });


                }



            }
            function EliminarE(button) {
                console.log(button)
                var nombre = button.value

                fetch(`http://localhost:3000/enfermeras/${nombre}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                        'Access-Control-Allow-Origin': '*',
                    }
                })
                    .then(res => res.json())
                    .catch(err => {
                        console.error('Error:', err)
                        alert("Ocurrio un error, ver la consola")
                    })
                    .then(response => {
                        console.log(response);
                        alert(response.Mensaje)
                        Actualizar()
                    })





            }
            function verPerfilE(boton) {
                console.log(boton)
                // En mi caso, yo use el value, lo asignamos a una variable.
                var usuario = boton.value

                /* sessionStorage, javascript cuenta con un almacenamiento para la pagina, este almacenamiento
                    estara vigente hasta que se cierre la pagina, es ideal para almacenar datos entre paginas.
                    Usamos el storage.setItem("llave", valor) donde llave es el atributo donde se guardara el valor del sessionStorage
                */
                sessionStorage.setItem("buscar", usuario)

                // CAMBIAR DE PAGINA, SIN USAR OTRA PAGINA
                // Usamos el location.href = "Pagina.html" para cambiar la pagina actual.
                location.href = "PerfilE.html"
            }
            function pdfEnfermero() {
                // Get the element.
                var element = document.getElementById('DanielE');

                // Generate the PDF.
                html2pdf().from(element).set({
                    margin: 0.5,
                    filename: 'enfermeros.pdf',
                    html2canvas: { scale: 10 },
                    jsPDF: { orientation: 'landscape', unit: 'in', format: 'letter', compressPDF: true }
                }).save();
            }

            //METODOS PARA PERSONAS
            function mostrartablaP() {
                var tabla = document.querySelector('#detallesP')

                // Esta cadena nos servira para escribir los datos en la tabla.
                var cadena = ''

                fetch('http://localhost:3000/datosp', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Access-Control-Allow-Origin': '*',
                    }
                })
                    .then(res => res.json())
                    .catch(err => {
                        console.error('Error:', err)
                        alert("Ocurrio un error, ver la consola")
                    })
                    .then(response => {
                        console.log(response);
                        // Usamos un foreach para darle el valor a un objeto dentro de un arreglo.

                        // arreglo.forEach(variable => {que se hara dentro del for})
                        response.forEach(element => {
                            // En este caso, element es el objeto que esta recorriendo el for, entonces por cada iteracion manipulamos a element
                            console.log(element)
                            // Agregamos a la cadena los datos de la respuesta del JSON para agregarlo a un table.
                            cadena += `<tr bgcolor="#85C1E9 " onmouseover="a(this,'#FDFEFE ')" onmouseout="b(this,'#85C1E9 ')">
                        <td> ${element.Nombre} </td>
                        <td> ${element.Apellido} </td>
                        <td> ${element.Sexo} </td>
                        <td> ${element.Usuario} </td>
                        <td> ${element.telefono} </td>
                        <td> <button value=${element.Nombre} onclick="verPerfilP(this)" type="button" class="btn btn-outline-dark">Ver Perfil</button> 
                         <button value=${element.Nombre} onclick="verPerfilP(this)" type="button" class="btn btn-outline-dark">Actualizar</button> 
                      <button value=${element.Nombre} onclick="EliminarP(this)" type="button" class="btn btn-outline-dark">Eliminar</button></td>
                      
                      </tr>`
                            // Cabe destacar que tambien se pueden agregar otras etiquetas, en si se trabaja como texto.
                            // NOTA: Recuerden no user '' si no que `` para que los deje usar el ${} y agregar variables al texto.
                        });

                        // POR ULTIMO: Usamos innerHTML para agregar el HTML a la etiqueta que indicamos anteriormente.
                        tabla.innerHTML = cadena
                    })
            }
            function CargaMasivaP() {

                $('#fileP').parse({
                    config: {
                        delimiter: ",",
                        complete: GuardarUsuariosP,
                    },
                    before: function (file, inputElem) {
                        console.log("parsing.file...", file);
                    },
                    error: function (err, file) {
                        console.log("ERROR", err, file)
                    },
                    complete: function () {
                        console.log("done with all files")
                        // CargarInfo()
                    }


                });

                function GuardarUsuariosP(resultados) {
                    console.log(resultados.data)
                    var data = resultados.data
                    data.shift();
                    data.forEach(element => {
                        console.log("esto es element")
                        console.log(element)
                        console.log("element en x posicion")
                        console.log(element[6])
                        var objEnfermero = {
                            'nombre': element[0],
                            'apellido': element[1],
                            'nacimiento': element[2],
                            'sexo': element[3],
                            'usuario': element[4],
                            'contra': element[5],
                            'telefono': element[6]


                        }
                        console.log("imprimiendo el objeto ya guardado")
                        console.log(objEnfermero)
                        if (objEnfermero.nombre != null) {
                            fetch('http://localhost:3000/Personas', {
                                method: 'POST',
                                body: JSON.stringify(objEnfermero),
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Access-Control-Allow-Origin': '*',
                                }
                            })

                                /* SIMULANDO UN TRY - CATCH
                                    El metodo fetch trabaja como una Promesa en JavaScript, representa el estado final del metodo
                                    como si de un return se tratase.
                                    .then: Para indicar que es lo que hara la respuesta del metodo, el primer then sirve para transformar la respuesta 
                                    a un JSON entendible para JavaScript.
                                    .catch: Para indicar que es lo que se hara si se obtuvo un fracaso.
                                */
                                .then(res => res.json())

                                .catch(err => {
                                    console.error('Error:', err)
                                    alert("Ocurrio un error, ver la consola")
                                })
                                /* ULTIMA TRANSFORMACION
                                    Si el metodo funciono correctamente y se logro transformar la respuesta en un JSON, hara lo que este dentro de las llaves.
                                */
                                .then(response => {
                                    // En este apargado, se haran las acciones si la respuesta fue correcta.
                                    console.log(response);
                                    // Usamos un alert, para desplegar un mensaje en pantalla de parte del navegador
                                    // Esto se puede reemplazar con mas librerias.
                                 //   alert(response.Mensaje)


                                    //  llamar un metodo definido
                                    //ObtenerDatos()
                                })//fetch
                        }


                    });


                }



            }

            function EliminarP(button) {
                console.log(button)
                var nombre = button.value

                fetch(`http://localhost:3000/Personas/${nombre}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                        'Access-Control-Allow-Origin': '*',
                    }
                })
                    .then(res => res.json())
                    .catch(err => {
                        console.error('Error:', err)
                        alert("Ocurrio un error, ver la consola")
                    })
                    .then(response => {
                        //console.log(response);
                        alert(response.Mensaje)
                        Actualizar()
                    })





            }
            function verPerfilP(boton) {
                console.log(boton)
                // En mi caso, yo use el value, lo asignamos a una variable.
                var usuario = boton.value

                /* sessionStorage, javascript cuenta con un almacenamiento para la pagina, este almacenamiento
                    estara vigente hasta que se cierre la pagina, es ideal para almacenar datos entre paginas.
                    Usamos el storage.setItem("llave", valor) donde llave es el atributo donde se guardara el valor del sessionStorage
                */
                sessionStorage.setItem("buscar", usuario)

                // CAMBIAR DE PAGINA, SIN USAR OTRA PAGINA
                // Usamos el location.href = "Pagina.html" para cambiar la pagina actual.
                location.href = "PerfilP.html"
            }
            function pdfPaciente() {
                // Get the element.
                var element = document.getElementById('DanielP');

                // Generate the PDF.
                html2pdf().from(element).set({
                    margin: 0.5,
                    filename: 'pacientes.pdf',
                    html2canvas: { scale: 10 },
                    jsPDF: { orientation: 'landscape', unit: 'in', format: 'letter', compressPDF: true }
                }).save();
            }
            //METODOS PARA MEDICAMENTOS
            function mostrartablaM() {
                var tabla = document.querySelector('#detallesM')

                // Esta cadena nos servira para escribir los datos en la tabla.
                var cadena = ''

                fetch('http://localhost:3000/medicamentos', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Access-Control-Allow-Origin': '*',
                    }
                })
                    .then(res => res.json())
                    .catch(err => {
                        console.error('Error:', err)
                        alert("Ocurrio un error, ver la consola")
                    })
                    .then(response => {
                        console.log(response);
                        // Usamos un foreach para darle el valor a un objeto dentro de un arreglo.

                        // arreglo.forEach(variable => {que se hara dentro del for})
                        response.forEach(element => {
                            // En este caso, element es el objeto que esta recorriendo el for, entonces por cada iteracion manipulamos a element
                            console.log(element)
                            // Agregamos a la cadena los datos de la respuesta del JSON para agregarlo a un table.
                            cadena += `<tr bgcolor="#85C1E9 " onmouseover="a(this,'#FDFEFE ')" onmouseout="b(this,'#85C1E9 ')">
                        <td> ${element.Id} </td>
                        <td> ${element.Nombre} </td>
                        <td> ${element.Precio} </td>
                        <td> ${element.Descripcion} </td>
                        <td> ${element.Cantidad} </td>
                        <td> <button value=${element.Id} onclick="verPerfilM(this)" type="button" class="btn btn-outline-dark">Ver Perfil</button> 
                         <button value=${element.Id} onclick="verPerfilM(this)" type="button" class="btn btn-outline-dark">Actualizar</button> 
                      <button value=${element.Id} onclick="EliminarM(this)" type="button" class="btn btn-outline-dark">Eliminar</button></td>
                      
                      </tr>`
                            // Cabe destacar que tambien se pueden agregar otras etiquetas, en si se trabaja como texto.
                            // NOTA: Recuerden no user '' si no que `` para que los deje usar el ${} y agregar variables al texto.
                        });

                        // POR ULTIMO: Usamos innerHTML para agregar el HTML a la etiqueta que indicamos anteriormente.
                        tabla.innerHTML = cadena
                    })
            }

            function CargaMasivaM() {

$('#fileM').parse({
    config: {
        delimiter: ",",
        complete: GuardarUsuariosM,
    },
    before: function (file, inputElem) {
        console.log("parsing.file...", file);
    },
    error: function (err, file) {
        console.log("ERROR", err, file)
    },
    complete: function () {
        console.log("done with all files")
        // CargarInfo()
    }


});

function GuardarUsuariosM(resultados) {
    console.log(resultados.data)
    var data = resultados.data
    var id =0;
    data.shift();
    data.forEach(element => {
        id= id+1
        
        var objMedicamento = {
            'id': id,
            'nombre': element[0],
            'precio': element[1],
            'descripcion': element[2],
            'cantidad': element[3]
            

        }
        console.log("imprimiendo el objeto ya guardado")
        console.log(objMedicamento)
        if (objMedicamento.id != 0) {
            fetch('http://localhost:3000/medicamentos', {
                method: 'POST',
                body: JSON.stringify(objMedicamento),
                headers: {
                    'Content-Type': 'application/json',
                    'Access-Control-Allow-Origin': '*',
                }
            })

                /* SIMULANDO UN TRY - CATCH
                    El metodo fetch trabaja como una Promesa en JavaScript, representa el estado final del metodo
                    como si de un return se tratase.
                    .then: Para indicar que es lo que hara la respuesta del metodo, el primer then sirve para transformar la respuesta 
                    a un JSON entendible para JavaScript.
                    .catch: Para indicar que es lo que se hara si se obtuvo un fracaso.
                */
                .then(res => res.json())

                .catch(err => {
                    console.error('Error:', err)
                    alert("Ocurrio un error, ver la consola")
                })
                /* ULTIMA TRANSFORMACION
                    Si el metodo funciono correctamente y se logro transformar la respuesta en un JSON, hara lo que este dentro de las llaves.
                */
                .then(response => {
                    // En este apargado, se haran las acciones si la respuesta fue correcta.
                    //console.log(response);
                    // Usamos un alert, para desplegar un mensaje en pantalla de parte del navegador
                    // Esto se puede reemplazar con mas librerias.
                  //  alert(response.Mensaje)

                    //  llamar un metodo definido
                    //ObtenerDatos()
                })//fetch
        }


    });


}
            }
            

            function pdfMedicamento() {
                // Get the element.
                var element = document.getElementById('DanielM');

                // Generate the PDF.
                html2pdf().from(element).set({
                    margin: 0.5,
                    filename: 'pacientes.pdf',
                    html2canvas: { scale: 10 },
                    jsPDF: { orientation: 'landscape', unit: 'in', format: 'letter', compressPDF: true }
                }).save();
            }
            function EliminarM(button) {
                console.log(button)
                var nombre = button.value

                fetch(`http://localhost:3000/medicamentos/${nombre}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                        'Access-Control-Allow-Origin': '*',
                    }
                })
                    .then(res => res.json())
                    .catch(err => {
                        console.error('Error:', err)
                        alert("Ocurrio un error, ver la consola")
                    })
                    .then(response => {
                        console.log(response);
                        alert(response.Mensaje)
                        Actualizar()
                    
                    })





            }
       
       
            function verPerfilM(boton) {
                console.log(boton)
                // En mi caso, yo use el value, lo asignamos a una variable.
                var usuario = boton.value

                /* sessionStorage, javascript cuenta con un almacenamiento para la pagina, este almacenamiento
                    estara vigente hasta que se cierre la pagina, es ideal para almacenar datos entre paginas.
                    Usamos el storage.setItem("llave", valor) donde llave es el atributo donde se guardara el valor del sessionStorage
                */
                sessionStorage.setItem("buscar", usuario)

                // CAMBIAR DE PAGINA, SIN USAR OTRA PAGINA
                // Usamos el location.href = "Pagina.html" para cambiar la pagina actual.
                location.href = "PerfilM.html"
            }
       </script>

        <!-- Option 2: Separate Popper and Bootstrap JS -->
        <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js" integrity="sha384-SR1sx49pcuLnqZUnnPwx6FCym0wLsk5JZuNx2bPPENzswTNFaQU1RDvt3wT4gWFG" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js" integrity="sha384-j0CNLUeiqtyaRmlzUHCPZ+Gy5fQu0dQ6eZ/xAww941Ai1SxSY+0EQqNXNE6DZiVc" crossorigin="anonymous"></script>
    -->
</body>
</head>

</html>